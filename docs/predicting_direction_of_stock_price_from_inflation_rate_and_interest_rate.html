

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Predicting direction of stock price from interest rate and inflation rate &#8212; Predicting direction of stock price from interest rate and inflation rate</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'predicting_direction_of_stock_price_from_inflation_rate_and_interest_rate';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
  
    <p class="title logo__title">Predicting direction of stock price from interest rate and inflation rate</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Predicting direction of stock price from interest rate and inflation rate
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/predicting_direction_of_stock_price_from_inflation_rate_and_interest_rate.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Predicting direction of stock price from interest rate and inflation rate</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Predicting direction of stock price from interest rate and inflation rate</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">Methods</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remarks">Remarks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-data-from-web">Read Data From Web</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#columns">columns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory Data Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-plots-of-features">Time Series Plots of Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histograms-of-features">Histograms of Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scatterplots-of-feature-pairs">Scatterplots of Feature Pairs</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-data">Preprocessing Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-regression">Dummy Regression</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#possible-reasons-for-worse-performance-of-the-logistic-regression-model-over-dummy-model">Possible Reasons for Worse Performance of the Logistic Regression Model over Dummy Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-of-picking-the-logistic-regression-model">Motivation of Picking the Logistic Regression Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overall">Overall</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">Reference</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="predicting-direction-of-stock-price-from-interest-rate-and-inflation-rate">
<h1>Predicting direction of stock price from interest rate and inflation rate<a class="headerlink" href="#predicting-direction-of-stock-price-from-interest-rate-and-inflation-rate" title="Permalink to this heading">#</a></h1>
<p><em>We utilized logistic regression to analyze the stock price data and provided a predictive model.</em></p>
<p>by Allan Lee, Andy Zhang, Yi Yan and Chengyu Tao (DSCI 522 Group 3 Milestone 3)</p>
<p>2023/12/06</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h1>
<p>In our exploration of the impact of inflation and interest rates on stock returns, we employed logistic regression to build a predictive model. The model, trained on data sourced from the S&amp;P500, CPI, and Federal funds rate, exhibited reasonable performance. In the context, we want to make sure every positive prediction is accurate and choose the metric precision which focuses specifically on maximizing the true positive predictions among all the instances predicted as positive.</p>
<p>Utilizing Python and packages such as Numpy, Pandas, Altair, and Scikit-learn, our analysis incorporated data preprocessing to address variations in sampling frequencies among S&amp;P500 index, CPI, and interest rate data. Resampling to the last day of every month and filtering noise through monthly median calculations were crucial steps in preparing the data for effective analysis.</p>
</section>
<section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h1>
<p>In the context of the current financial landscape shaped by the COVID-19 pandemic, central banks globally responded by lowering interest rates to mitigate economic challenges. However, this led to heightened inflation due to increased consumer spending. In an effort to regain control and revert to pre-pandemic levels, central banks sharply raised interest rates to the highest point in 15 years. With over 50% of American households owning stocks <span id="id1">[<a class="reference internal" href="#id11" title="The Motley Fool. How many americans own stock? more than you think. 2023. URL: https://www.fool.com/research/how-many-americans-own-stock/.">Fool, 2023</a>]</span>, the team is keen to explore the impact of inflation and interest rates on stock returns. The pivotal question arises: Can we predict profitable outcomes in stock market index investments over a one-year period based on inflation and interest rate data? Recognizing the potential financial and emotional impact of losing investments and related mental health issues, the team prioritizes precision to minimize setbacks and maximize returns.</p>
</section>
<section id="methods">
<h1>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">#</a></h1>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>We decided to use the Standard &amp; Poors 500 Index (S&amp;P500) as stock market proxy. The index tracks stocks of 500 largest companies in USA. The price of S&amp;P500 is obtained from Yahoo Finance <span id="id2">[<a class="reference internal" href="#id10" title="Yahoo. S&amp;p 500. 2023. URL: https://ca.finance.yahoo.com/quote/%5EGSPCp=%5EGSPC&amp;.tsrc=fin-srch.">Yahoo, 2023</a>]</span>.</p></li>
<li><p>Inflation data is obtained from calculating the change of consumer price index (CPI) <span id="id3">[<a class="reference internal" href="#id10" title="Yahoo. S&amp;p 500. 2023. URL: https://ca.finance.yahoo.com/quote/%5EGSPCp=%5EGSPC&amp;.tsrc=fin-srch.">Yahoo, 2023</a>]</span>. We obtained United States CPI from the Federal Reserve Economic Data website and computed yearly inflation rate.</p></li>
<li><p>We can use the Federal funds rate as proxy for interest rate. It is the target interest rate set by the Federal reserve for commercial banks to lend and borrow overnight. We obtained the Federal funds rate from the Federal Reserve Economic Data website.</p></li>
</ol>
<p>We derived the change in inflation rate and change in interest rate from the data we have as additional feature. We often hear on the news that inflation and interest rate are increasing or decreasing thus we thought these 2 features might provide additional predicting power for our model.</p>
</section>
<section id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading">#</a></h2>
<p>The Python programming language <span id="id4">[<a class="reference internal" href="#id16" title="Guido Van Rossum, Fred L Drake, and others. Python reference manual. Volume 111. Centrum voor Wiskunde en Informatica Amsterdam, 1995.">Van Rossum <em>et al.</em>, 1995</a>]</span> and the following Python packages were used to perform the analysis:  Numpy <span id="id5">[<a class="reference internal" href="#id12" title="Charles R Harris, K Jarrod Millman, Stéfan J Van Der Walt, Ralf Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, Julian Taylor, Sebastian Berg, Nathaniel J Smith, and others. Array programming with numpy. Nature, 585(7825):357–362, 2020.">Harris <em>et al.</em>, 2020</a>]</span>, Pandas <span id="id6">[<a class="reference internal" href="#id13" title="Wes McKinney. Data structures for statistical computing in python. In Stéfan van der Walt and Jarrod Millman, editors, Proceedings of the 9th Python in Science Conference, =51 - 56. 2010.">McKinney, 2010</a>]</span>, Altair <span id="id7">[<a class="reference internal" href="#id15" title="Jacob VanderPlas, Brian Granger, Jeffrey Heer, Dominik Moritz, Kanit Wongsuphasawat, Arvind Satyanarayan, Eitan Lees, Ilia Timofeev, Ben Welsh, and Scott Sievert. Altair: interactive statistical visualizations for python. Journal of open source software, 3(32):1057, 2018.">VanderPlas <em>et al.</em>, 2018</a>]</span>, Scikit-learn <span id="id8">[<a class="reference internal" href="#id14" title="Fabian Pedregosa, Gaël Varoquaux, Alexandre Gramfort, Vincent Michel, Bertrand Thirion, Olivier Grisel, Mathieu Blondel, Peter Prettenhofer, Ron Weiss, Vincent Dubourg, and others. Scikit-learn: machine learning in python. the Journal of machine Learning research, 12:2825–2830, 2011.">Pedregosa <em>et al.</em>, 2011</a>]</span>. The code used to perform the EDA and create the report which can be found here: <a class="github reference external" href="https://github.com/UBC-MDS/dsci_522_group_3/tree/main">UBC-MDS/dsci_522_group_3</a>.</p>
</section>
<section id="remarks">
<h2>Remarks<a class="headerlink" href="#remarks" title="Permalink to this heading">#</a></h2>
<p>S&amp;P500 index, CPI, and Interest rate data we obtained have different sampling frequencies. CPI data has the lowest frequency and it is sampled every first day of the month. We decided to resample all data to last day of every month thus it is easy to calculate and interpret year-year and month-month change. Interest rate data was sampled daily and it is noisy. We decided to filter the data by taking monthly median during resampling. The following table summarizes how data preprocessing was done.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Data</p></th>
<th class="head"><p>Original sampling period</p></th>
<th class="head"><p>Preprocess procedure</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>S&amp;P 500 Index</p></td>
<td><p>daily</p></td>
<td><p>Take the value from last day of month. If we do not have data for last day of month, use the data from the closest previous date</p></td>
</tr>
<tr class="row-odd"><td><p>CPI</p></td>
<td><p>first day of every month</p></td>
<td><p>Offset the date by 1 to last day of last month. We thought the value difference for 1 day is neglegible</p></td>
</tr>
<tr class="row-even"><td><p>Interest Rate</p></td>
<td><p>daily</p></td>
<td><p>Resample to the last day of month by taking the median price of for every day of the month to filter for noise</p></td>
</tr>
</tbody>
</table>
</section>
<section id="read-data-from-web">
<h2>Read Data From Web<a class="headerlink" href="#read-data-from-web" title="Permalink to this heading">#</a></h2>
<p>The desciption of our data is shown below.</p>
<section id="columns">
<h3>columns<a class="headerlink" href="#columns" title="Permalink to this heading">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>column name</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>gspc</p></td>
<td><p>price of S&amp;P 500 stock index (will be ignored for model)</p></td>
</tr>
<tr class="row-odd"><td><p>inflation_rate_pct</p></td>
<td><p>1 year inflation rate (12 months ago to now) (will be a feature for model)</p></td>
</tr>
<tr class="row-even"><td><p>interest_rate_pct</p></td>
<td><p>interest rate (will be a feature for model)</p></td>
</tr>
<tr class="row-odd"><td><p>inflation_rate_pct_chg</p></td>
<td><p>change of inflation between now and 12 months ago (will be a feature for model)</p></td>
</tr>
<tr class="row-even"><td><p>interest_rate_pct_chg</p></td>
<td><p>change of interest rate between now and 12 months ago (will be a feature for model)</p></td>
</tr>
<tr class="row-odd"><td><p>gspc_prev_year_chg_pct</p></td>
<td><p>change of gspc between now and 12 months ago (will be a feature for model)</p></td>
</tr>
<tr class="row-even"><td><p>gspc_next_year_pct_chg</p></td>
<td><p>change of gspc between now and 12 months later (will be used to get target)</p></td>
</tr>
<tr class="row-odd"><td><p>target</p></td>
<td><p>whether gspc increased 12 months later compared to now (will be target for classification)</p></td>
</tr>
</tbody>
</table>
<figure class="align-default" id="data-head">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>gspc</th>
      <th>gspc_next_year_pct_chg</th>
      <th>gspc_prev_year_pct_chg</th>
      <th>inflation_rate_pct</th>
      <th>inflation_rate_pct_chg</th>
      <th>interest_rate_pct</th>
      <th>interest_rate_pct_chg</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1955-07-31</td>
      <td>43.520000</td>
      <td>13.488049</td>
      <td>40.932648</td>
      <td>-0.371747</td>
      <td>-0.371747</td>
      <td>1.69</td>
      <td>0.94</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1955-08-31</td>
      <td>43.180000</td>
      <td>10.027786</td>
      <td>44.753605</td>
      <td>0.373134</td>
      <td>0.744882</td>
      <td>2.00</td>
      <td>0.62</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1955-09-30</td>
      <td>43.669998</td>
      <td>3.847035</td>
      <td>35.159382</td>
      <td>0.373134</td>
      <td>1.113875</td>
      <td>2.19</td>
      <td>1.00</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1955-10-31</td>
      <td>42.340000</td>
      <td>7.652342</td>
      <td>33.648989</td>
      <td>0.373134</td>
      <td>0.744882</td>
      <td>2.25</td>
      <td>1.25</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1955-11-30</td>
      <td>45.509998</td>
      <td>-0.944840</td>
      <td>32.914708</td>
      <td>0.374532</td>
      <td>1.118026</td>
      <td>2.25</td>
      <td>1.37</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Present the head of the processed data.</span><a class="headerlink" href="#data-head" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="exploratory-data-analysis">
<h1>Exploratory Data Analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this heading">#</a></h1>
<p>In our preliminary analysis, we find out:</p>
<ul class="simple">
<li><p>No NA or missing data in dataset</p></li>
<li><p>One row record the observation for one month.</p></li>
<li><p>The time series data is from 1955-07 to 2022-10, which contains 808 observations.</p></li>
<li><p>The target is <code class="docutils literal notranslate"><span class="pre">True</span></code> when the stock price went up, and is <code class="docutils literal notranslate"><span class="pre">False</span></code> when the stock price went down.</p></li>
<li><p>The four columns <code class="docutils literal notranslate"><span class="pre">inflation_rate_pct</span></code>, <code class="docutils literal notranslate"><span class="pre">interest_rate_pct</span></code>,
<code class="docutils literal notranslate"><span class="pre">inflation_rate_pct_chg</span></code>, <code class="docutils literal notranslate"><span class="pre">interest_rate_pct_chg</span></code>,
<code class="docutils literal notranslate"><span class="pre">gspc_prev_year_pct_chg</span></code> are treated as features, and the target is treated as response in this binary classification problem.</p></li>
</ul>
<section id="time-series-plots-of-features">
<h2>Time Series Plots of Features<a class="headerlink" href="#time-series-plots-of-features" title="Permalink to this heading">#</a></h2>
<p>The visualization of time series may reveal the pattern of data, we plot them as follows.</p>
<figure class="align-default" id="time-series">
<a class="reference internal image-reference" href="_images/time.png"><img alt="_images/time.png" src="_images/time.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Time Series Plots of Features</span><a class="headerlink" href="#time-series" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="histograms-of-features">
<h2>Histograms of Features<a class="headerlink" href="#histograms-of-features" title="Permalink to this heading">#</a></h2>
<p>We plot the histograms to see the range and mode of interesting features.</p>
<figure class="align-default" id="histogram">
<a class="reference internal image-reference" href="_images/hist.png"><img alt="_images/hist.png" src="_images/hist.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Histograms of Features</span><a class="headerlink" href="#histogram" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="scatterplots-of-feature-pairs">
<h2>Scatterplots of Feature Pairs<a class="headerlink" href="#scatterplots-of-feature-pairs" title="Permalink to this heading">#</a></h2>
<p>Spearmean’s rank correlation test may reveal some potential correlation, we draw the scatterplots of following feature pairs:</p>
<p><code class="docutils literal notranslate"><span class="pre">interest_rate_pct</span> <span class="pre">vs</span> <span class="pre">inflation_rate_pct</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">interest_rate_pct_chg</span> <span class="pre">vs</span> <span class="pre">inflation_rate_pct_chg</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">inflation_rate_pct_chg</span> <span class="pre">vs</span> <span class="pre">inflation_rate_pct</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">interest_rate_pct_chg</span> <span class="pre">vs</span> <span class="pre">interest_rate_pct</span></code></p>
<figure class="align-default" id="scatter-plot">
<a class="reference internal image-reference" href="_images/scat.png"><img alt="_images/scat.png" src="_images/scat.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Scatter plots of a few pairs of variables</span><a class="headerlink" href="#scatter-plot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Examine the data type for every column.</p></li>
<li><p>Illustrate the distribution of all numeric columns and investigate possible correlations between them.</p></li>
<li><p>Divide the dataframe into training and testing datasets with an 80:20 ratio.</p></li>
<li><p>Based on the histograms of all columns, the five numerical columns ‘inflation_rate_pct’, ‘interest_rate_pct’, ‘inflation_rate_pct_chg’, ‘interest_rate_pct_chg’, and ‘gspc_prev_year_pct_chg’ are helpful in separating the target.</p></li>
</ul>
</section>
</section>
<section id="model">
<h1>Model<a class="headerlink" href="#model" title="Permalink to this heading">#</a></h1>
<section id="preprocessing-data">
<h2>Preprocessing Data<a class="headerlink" href="#preprocessing-data" title="Permalink to this heading">#</a></h2>
<p>The dataset comprises records for 808 months, with each row featuring a crucial predictor for the corresponding month. Additionally, it indicates whether there was an increase or decrease in the S&amp;P 500 index, denoted by the values <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>We find numeric features are: <code class="docutils literal notranslate"><span class="pre">inflation_rate_pct</span></code>, <code class="docutils literal notranslate"><span class="pre">interest_rate_pct</span></code>, <code class="docutils literal notranslate"><span class="pre">inflation_rate_pct_chg</span></code>, <code class="docutils literal notranslate"><span class="pre">interest_rate_pct_chg</span></code>, <code class="docutils literal notranslate"><span class="pre">gspc_prev_year_pct_chg</span></code>. Since there is no missing values, imputation is not necessary. As the characteristics were exclusively numerical, we utilized a StandardScaler to guarantee the normalization of feature matrix.</p>
</section>
<section id="logistic-regression">
<h2>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Permalink to this heading">#</a></h2>
<p>Predicting exact stock prices is challenging, so we simplify the task by transforming it into a binary classification problem—predicting whether the stock price will increase or decrease. Our focus is on identifying whether there is an increase in the S&amp;P 500 index, making it a binary classification problem. To tackle this, we utilize Logistic Regression.</p>
<figure class="align-default" id="regression-mean-test-score">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>logistic_regression_precision_score (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>76.1</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Present results of logistic regression model.</span><a class="headerlink" href="#regression-mean-test-score" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The test data of logistic regression yields an precision of <span class="pasted-text">76.1</span>%. Precision is calculated as the number of true positives divided by the sum of true positives and false positives. Nevertheless, caution is necessary when interpreting this metric.</p>
</section>
<section id="dummy-regression">
<h2>Dummy Regression<a class="headerlink" href="#dummy-regression" title="Permalink to this heading">#</a></h2>
<figure class="align-default" id="dummy-mean-test-score">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dummy_model_precision_score (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75.93</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Present results of dummy model.</span><a class="headerlink" href="#dummy-mean-test-score" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="discussion">
<h1>Discussion<a class="headerlink" href="#discussion" title="Permalink to this heading">#</a></h1>
<p>In concluding this report, we express gratitude for the valuable input received from four reviewers and aim to address significant queries in the discussion section.</p>
<section id="possible-reasons-for-worse-performance-of-the-logistic-regression-model-over-dummy-model">
<h2>Possible Reasons for Worse Performance of the Logistic Regression Model over Dummy Model<a class="headerlink" href="#possible-reasons-for-worse-performance-of-the-logistic-regression-model-over-dummy-model" title="Permalink to this heading">#</a></h2>
<p>The quality of the data, including missing values, outliers, or noise, can significantly impact the performance of any predictive model. If the data is noisy or contains irrelevant information, the model’s accuracy may suffer. Stock price movements are influenced by a wide range of factors, and if the model does not have access to relevant information, it may struggle to make accurate predictions.</p>
</section>
<section id="motivation-of-picking-the-logistic-regression-model">
<h2>Motivation of Picking the Logistic Regression Model<a class="headerlink" href="#motivation-of-picking-the-logistic-regression-model" title="Permalink to this heading">#</a></h2>
<p>Logistic regression is specifically designed for binary classification problems where the outcome variable is dichotomous, meaning it has two possible classes (e.g., 0 or 1, true or false, positive or negative). The coefficients in logistic regression represent the log-odds of the target variable, making it easy to interpret the impact of each feature on the likelihood of a particular outcome. This interpretability is valuable for understanding the relationships between variables.</p>
</section>
<section id="overall">
<h2>Overall<a class="headerlink" href="#overall" title="Permalink to this heading">#</a></h2>
<p>The model training is designed such that it follows the Golden Rule, which refers to “despite our utmost concern for test error, it is crucial to emphasize that the training phase must remain completely unaffected by the test data.” The test data of dummy regression yields a precision of <span class="pasted-text">75.93</span>%. The precision of dummy regression is better then the precision of logistic regression. In the preceding examination, we utilize <code class="docutils literal notranslate"><span class="pre">Logistic</span> <span class="pre">Regression</span></code> and <code class="docutils literal notranslate"><span class="pre">Dummy</span> <span class="pre">Regression</span></code>. Consequently, the result does not show advantage of <code class="docutils literal notranslate"><span class="pre">Logistic</span> <span class="pre">Regression</span></code> over <code class="docutils literal notranslate"><span class="pre">Dummy</span> <span class="pre">Regression</span></code>. (see <a class="reference internal" href="#result-df"><span class="std std-numref">Figure 7</span></a>) Further data preprocessing is needed to enhance the overall effectiveness of the model. This is aligned with expectation, because we do not have enough meaningful features to extract information that is helpful for a more accurate categorization. Also, we have imbalanced classes, which can also prevent the model from determining whether the index will grow.</p>
<p>The model’s performance may be sensitive to hyperparameter settings, therefore it can be helpful to improve the model performance to experiment with different configurations through hyperparameter tuning. In the future, to improve the performance of the model, we may want to consult with specialists of finance field to get more key information about the topic. This will allow more features to be added to the data and positively impact the model training.</p>
<figure class="align-default" id="result-df">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dummy_model_precision_score (%)</th>
      <th>logistic_regression_precision_score (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75.93</td>
      <td>76.1</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Comparison of Dummy model and Logistic Regression Score on Test Data</span><a class="headerlink" href="#result-df" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this heading">#</a></h1>
<div class="docutils container" id="id9">
<dl class="citation">
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id1">Foo23</a></span></dt>
<dd><p>The Motley Fool. How many americans own stock? more than you think. 2023. URL: <a class="reference external" href="https://www.fool.com/research/how-many-americans-own-stock/">https://www.fool.com/research/how-many-americans-own-stock/</a>.</p>
</dd>
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id5">HMVDW+20</a></span></dt>
<dd><p>Charles R Harris, K Jarrod Millman, Stéfan J Van Der Walt, Ralf Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, Julian Taylor, Sebastian Berg, Nathaniel J Smith, and others. Array programming with numpy. <em>Nature</em>, 585(7825):357–362, 2020.</p>
</dd>
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id6">McK10</a></span></dt>
<dd><p>Wes McKinney. Data structures for statistical computing in python. In Stéfan van der Walt and Jarrod Millman, editors, <em>Proceedings of the 9th Python in Science Conference</em>, =51 – 56. 2010.</p>
</dd>
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id8">PVG+11</a></span></dt>
<dd><p>Fabian Pedregosa, Gaël Varoquaux, Alexandre Gramfort, Vincent Michel, Bertrand Thirion, Olivier Grisel, Mathieu Blondel, Peter Prettenhofer, Ron Weiss, Vincent Dubourg, and others. Scikit-learn: machine learning in python. <em>the Journal of machine Learning research</em>, 12:2825–2830, 2011.</p>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id4">VRD+95</a></span></dt>
<dd><p>Guido Van Rossum, Fred L Drake, and others. <em>Python reference manual</em>. Volume 111. Centrum voor Wiskunde en Informatica Amsterdam, 1995.</p>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id7">VGH+18</a></span></dt>
<dd><p>Jacob VanderPlas, Brian Granger, Jeffrey Heer, Dominik Moritz, Kanit Wongsuphasawat, Arvind Satyanarayan, Eitan Lees, Ilia Timofeev, Ben Welsh, and Scott Sievert. Altair: interactive statistical visualizations for python. <em>Journal of open source software</em>, 3(32):1057, 2018.</p>
</dd>
<dt class="label" id="id10"><span class="brackets">Yah23</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Yahoo. S&amp;p 500. 2023. URL: <a class="reference external" href="https://ca.finance.yahoo.com/quote/%5EGSPCp=%5EGSPC&amp;.tsrc=fin-srch">https://ca.finance.yahoo.com/quote/%5EGSPCp=%5EGSPC&amp;.tsrc=fin-srch</a>.</p>
</dd>
</dl>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Predicting direction of stock price from interest rate and inflation rate</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">Methods</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remarks">Remarks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-data-from-web">Read Data From Web</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#columns">columns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory Data Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-plots-of-features">Time Series Plots of Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histograms-of-features">Histograms of Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scatterplots-of-feature-pairs">Scatterplots of Feature Pairs</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-data">Preprocessing Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-regression">Dummy Regression</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#possible-reasons-for-worse-performance-of-the-logistic-regression-model-over-dummy-model">Possible Reasons for Worse Performance of the Logistic Regression Model over Dummy Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-of-picking-the-logistic-regression-model">Motivation of Picking the Logistic Regression Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overall">Overall</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">Reference</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allan Lee, Jianhao Zhang, Yi Yan, Chengyu Tao
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>